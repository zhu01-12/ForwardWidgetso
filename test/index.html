<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>ğ™ˆğ™–ğ™ ğ™ ğ™–ğ™‹ğ™–ğ™ ğ™ ğ™–'s ğ™’ğ™ğ™™ğ™œğ™šğ™©ğ™¨</title>
    
    <link rel="icon" href="https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/main/icon.png" type="image/png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;700;800&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Outfit"', '-apple-system', 'sans-serif'],
                    },
                    animation: {
                        'spin-slow': 'spin 8s linear infinite',
                    }
                }
            }
        }
    </script>

    <style>
        /* ğŸŒŒ åŸºç¡€è®¾ç½® */
        body {
            background-color: #050505;
            color: white;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* =========================================
           ğŸ¬ æµ·æŠ¥å¢™ç‰¹æ•ˆæ ¸å¿ƒæ ·å¼ (ä¿®æ”¹éƒ¨åˆ†)
        ========================================= */
        
        /* 1. æœ€å¤–å±‚åŒ…è£¹å™¨ï¼šè´Ÿè´£å€¾æ–œå’Œå®šä½ */
        #poster-wall-wrapper {
            position: absolute;
            top: -50%; /* è®©å®ƒè¶…å‡ºå±å¹•ä»¥ä¾¿å€¾æ–œæ—¶ä¸éœ²é¦… */
            left: -50%;
            width: 200%;
            height: 200%;
            z-index: -1;
            transform: rotate(-12deg); /* æ•´ä½“å€¾æ–œè§’åº¦ */
            overflow: hidden;
            pointer-events: none;
            /* å¢åŠ ä¸€ç‚¹æ•´ä½“äº®åº¦ */
            filter: brightness(1.1);
        }

        /* 2. ç§»åŠ¨å±‚ï¼šè´Ÿè´£æ‰¿è½½ä¸¤ä¸ªç½‘æ ¼å¹¶è¿›è¡ŒåŠ¨ç”» */
        #poster-wall-mover {
            width: 100%;
            /* å…³é”®ï¼šè®¾ç½®è¶³å¤Ÿé«˜çš„é«˜åº¦æ¥å®¹çº³ä¸¤ä¸ªå †å çš„ç½‘æ ¼ */
            display: flex;
            flex-direction: column;
            /* åº”ç”¨æ— é™æ»šåŠ¨åŠ¨ç”»ï¼š60ç§’å®Œæˆä¸€æ¬¡å¾ªç¯ï¼Œçº¿æ€§åŒ€é€Ÿ */
            animation: wallScrollUp 80s linear infinite;
        }

        /* å®šä¹‰å‘ä¸Šæ»šåŠ¨çš„å…³é”®å¸§ */
        @keyframes wallScrollUp {
            0% {
                transform: translateY(0);
            }
            100% {
                /* å‘ä¸Šç§»åŠ¨è‡ªèº«é«˜åº¦çš„ 50% (å› ä¸ºé‡Œé¢æœ‰ä¸¤ä¸ªç›¸åŒçš„ç½‘æ ¼å åœ¨ä¸€èµ·) */
                transform: translateY(-50%);
            }
        }

        /* 3. ç½‘æ ¼å±‚ï¼šå®é™…çš„æµ·æŠ¥å¸ƒå±€ */
        .poster-grid {
            display: grid;
            /* å“åº”å¼åˆ—æ•°è®¾ç½® */
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            padding: 8px;
            width: 100%;
            /* ç¡®ä¿ç½‘æ ¼é‡Œçš„å›¾ç‰‡ä¸ä¼šè¢«æ‹‰ä¼¸å˜å½¢ */
            align-content: start; 
        }
        @media (min-width: 768px) { .poster-grid { grid-template-columns: repeat(6, 1fr); } }
        @media (min-width: 1024px) { .poster-grid { grid-template-columns: repeat(8, 1fr); } }

        
        /* æµ·æŠ¥å›¾ç‰‡æ ·å¼ (å·²æé«˜æ¸…æ™°åº¦) */
        .poster-img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            /* ä¿®æ”¹ï¼šæé«˜ä¸é€æ˜åº¦ */
            opacity: 0.75; 
            transition: opacity 0.3s;
            box-shadow: 0 4px 8px -2px rgba(0, 0, 0, 0.6);
            /* ä¿®æ”¹ï¼šé™ä½ç°åº¦ï¼Œè®©è‰²å½©æ›´è·³è·ƒä¸€ç‚¹ */
            filter: grayscale(10%); 
            /* ç¡®ä¿å›¾ç‰‡å¡«å……ä¸”ä¸å˜å½¢ */
            object-fit: cover;
            aspect-ratio: 2/3; /* å¼ºåˆ¶æµ·æŠ¥æ¯”ä¾‹ */
        }

        /* é®ç½©å±‚ (å·²é™ä½æ¨¡ç³Šåº¦) */
        .bg-overlay {
            position: absolute;
            inset: 0;
            z-index: -1;
            /* ç¨å¾®è°ƒæ•´äº†æ¸å˜ï¼Œè®©ä¸­é—´éƒ¨åˆ†æ›´é€äº®ä¸€ç‚¹ */
            background: linear-gradient(180deg, 
                rgba(5,5,5,0.6) 0%, 
                rgba(5,5,5,0.3) 40%, 
                rgba(5,5,5,0.7) 100%);
            /* ä¿®æ”¹ï¼šæ˜¾è‘—é™ä½æ¨¡ç³Šåº¦ï¼Œæé«˜èƒŒæ™¯å¯è¯»æ€§ */
            backdrop-filter: blur(1px); 
            pointer-events: none;
        }
        /* ========================================= */


        /* ğŸƒ æ»‘åŠ¨å®¹å™¨ */
        .snap-x-mandatory { scroll-snap-type: x mandatory; }
        .snap-center { scroll-snap-align: center; }
        #slider-container {
            padding: 0 max(calc(50vw - 130px), 2rem);
        }

        /* ğŸŒˆ å¡ç‰‡æ¸å˜ */
        .card-gradient-1 { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); }
        .card-gradient-2 { background: linear-gradient(135deg, #3b82f6 0%, #2dd4bf 100%); }
        .card-gradient-3 { background: linear-gradient(135deg, #f43f5e 0%, #f59e0b 100%); }
        .card-gradient-4 { background: linear-gradient(135deg, #10b981 0%, #3b82f6 100%); }
        
        /* ğŸ¥š å¤´åƒç‰¹æ•ˆ */
        .spin-trigger { transition: transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .spin-active { transform: rotate(1080deg); }

        /* ğŸ“± åº•éƒ¨ Dock */
        .bottom-dock {
            padding-bottom: env(safe-area-inset-bottom);
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-top: 1px solid rgba(255,255,255,0.08);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* 3D ç‰¹æ•ˆ */
        .widget-card {
            transition: transform 0.3s ease-out, opacity 0.3s ease-out, filter 0.3s ease-out;
            transform-origin: center center;
            opacity: 0.6;
            transform: scale(0.92);
            filter: blur(1px);
        }
        .widget-card.is-active {
            opacity: 1;
            transform: scale(1.05);
            filter: blur(0px);
            z-index: 10;
            box-shadow: 0 20px 50px -12px rgba(0, 0, 0, 0.8);
        }

        /* ğŸŒ è¯­è¨€é€‰æ‹©å™¨ */
        .lang-select {
            appearance: none;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 4px 10px;
            border-radius: 99px;
            font-size: 12px;
            backdrop-filter: blur(10px);
            outline: none;
            text-align: center;
        }
        .lang-select option { background: #1e293b; color: white; }
    </style>
</head>
<body class="antialiased">

    <div id="poster-wall-wrapper">
        <div id="poster-wall-mover">
            <div id="poster-grid-1" class="poster-grid"></div>
            <div id="poster-grid-2" class="poster-grid"></div>
        </div>
    </div>
    
    <div class="bg-overlay"></div>

    <div class="absolute top-6 right-6 z-50">
        <select id="lang-switcher" class="lang-select" onchange="changeLanguage(this.value)">
            <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
            <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
            <option value="en">English</option>
        </select>
    </div>

    <header class="pt-8 px-6 text-center shrink-0 z-10 relative">
        <div class="relative w-[90px] h-[90px] mx-auto mb-4 group cursor-pointer" onclick="spinAvatar(this)">
            <div class="absolute -inset-1 bg-[conic-gradient(from_0deg,transparent_0_340deg,white_360deg)] opacity-20 animate-spin-slow rounded-full"></div>
            <div class="absolute inset-0 bg-gradient-to-tr from-cyan-500 to-blue-600 rounded-full blur-md opacity-60"></div>
            <img src="https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/tubiao/makkawidgets.jpg" 
                 class="spin-trigger relative w-full h-full rounded-full border-[3px] border-white/90 object-cover z-10 shadow-2xl" 
                 alt="Avatar">
        </div>
        
        <h1 class="text-3xl font-extrabold tracking-tight mb-1 cursor-pointer select-none active:scale-95 transition-transform" 
            onclick="randomTitleColor(this)">
            <span id="title-text" class="bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400">
                MakkaPakka's Widgets
            </span>
        </h1>
        <p id="subtitle" class="text-white/50 text-sm font-medium">å·¦å³æ»‘åŠ¨é€‰æ‹©ç»„ä»¶</p>
    </header>

    <main class="flex-grow flex flex-col justify-center py-2 overflow-hidden z-10">
        <div id="slider-container" 
             class="flex overflow-x-auto hide-scrollbar snap-x-mandatory gap-4 items-center h-full w-full pb-2">
            </div>
    </main>

    <div class="bottom-dock w-full fixed bottom-0 left-0 z-50">
        
        <a href="https://t.me/makkapakka777" target="_blank"
           class="mb-3 px-4 py-1.5 rounded-full bg-white/5 border border-white/10 text-white/70 text-xs font-medium backdrop-blur-sm flex items-center hover:bg-white/10 transition-colors">
            <i class="fa-brands fa-telegram mr-1.5"></i>
            <span id="contact-btn-text">è”ç³»ä½œè€…</span>
        </a>

        <div class="w-full max-w-md mx-auto px-6 grid grid-cols-2 gap-4 mb-3">
            <button onclick="togglePreview(true)"
               class="flex items-center justify-center py-3.5 rounded-2xl bg-white/10 border border-white/10 text-white font-bold backdrop-blur-md active:scale-95 transition-transform">
                <i class="fa-solid fa-eye mr-2 text-emerald-400"></i>
                <span id="btn-preview" class="text-sm">ä¸€é”®å¯¼å…¥æˆ‘çš„é¦–é¡µ</span>
            </button>
            
            <a id="import-all-btn" href="#"
               class="flex items-center justify-center py-3.5 rounded-2xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold shadow-lg shadow-blue-900/40 active:scale-95 transition-transform">
                <i class="fa-solid fa-layer-group mr-2"></i>
                <span id="btn-import-all" class="text-sm">ä¸€é”®å¯¼å…¥å…¨éƒ¨æ¨¡å—</span>
            </a>
        </div>

        <div class="text-[10px] text-white/30 font-medium tracking-wide pb-2">
            Â© 2026 ğ™ˆğ™–ğ™ ğ™ ğ™–ğ™‹ğ™–ğ™ ğ™ ğ™– â€¢ Forward
        </div>
    </div>

    <div id="preview-modal" class="fixed inset-0 z-[60] flex items-center justify-center bg-black/80 backdrop-blur-md hidden opacity-0 transition-opacity duration-300">
        <div class="relative w-full h-full flex flex-col items-center justify-center p-6" onclick="if(event.target===this) togglePreview(false)">
            <button onclick="togglePreview(false)" class="absolute top-6 right-6 w-10 h-10 bg-white/10 rounded-full flex items-center justify-center text-white backdrop-blur">
                <i class="fa-solid fa-times"></i>
            </button>
            <div class="max-w-sm w-full bg-white/5 border border-white/10 rounded-3xl overflow-hidden shadow-2xl flex flex-col max-h-[80vh]">
                <div class="p-4 bg-white/5 backdrop-blur border-b border-white/5 flex justify-between items-center">
                    <span id="modal-title" class="text-white font-bold">ä¸‹æ»‘é¢„è§ˆ</span>
                    <span class="text-xs text-rose-400 bg-rose-400/10 px-2 py-1 rounded">Forward â‰¥ 1.3.14</span>
                </div>
                <div class="overflow-y-auto flex-1 bg-black/20">
                    <img src="https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/VIEW3.JPEG" class="w-full h-auto" alt="Preview">
                </div>
                <div class="p-4 bg-white/5 backdrop-blur border-t border-white/5">
                    <a href="https://forward-h5.inch.red/s/makkapakka518" class="block w-full py-3 bg-emerald-500 rounded-xl text-center text-white font-bold shadow-lg shadow-emerald-500/30 active:scale-95 transition-transform">
                        <span id="modal-btn">ç¡®è®¤å¹¶å¯¼å…¥é…ç½®</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // ğŸ¬ 1. æµ·æŠ¥å¢™é€»è¾‘ (TMDB API & åŠ¨ç”»å‡†å¤‡)
        // ==========================================
        
        // ğŸ”´ğŸ”´ğŸ”´ è¯·åœ¨è¿™é‡Œå¡«å…¥ä½ çš„ TMDB API Key ğŸ”´ğŸ”´ğŸ”´
        const TMDB_API_KEY = 'YOUR_TMDB_API_KEY_HERE'; 
        // ğŸ”´ğŸ”´ğŸ”´ å¦‚æœæ²¡æœ‰ Keyï¼Œè¯·ç•™ç©ºï¼Œç³»ç»Ÿä¼šä½¿ç”¨ä¸‹æ–¹å¤‡ç”¨å›¾ç‰‡å±•ç¤ºæ•ˆæœ

        async function initPosterWall() {
            // è·å–ä¸¤ä¸ªç½‘æ ¼å®¹å™¨
            const grid1 = document.getElementById('poster-grid-1');
            const grid2 = document.getElementById('poster-grid-2');

            const posterBaseUrl = 'https://image.tmdb.org/t/p/w300';
            let posters = [];

            // å¤‡ç”¨å›¾ç‰‡æ•°æ® (å¦‚æœæ²¡æœ‰ API KEY åˆ™ä½¿ç”¨è¿™äº›)
            // ä½¿ç”¨äº†ä¸€å¼ çœŸå®çš„ TMDB å›¾ç‰‡ï¼Œä½ å¯ä»¥æ›¿æ¢æˆä½ å–œæ¬¢çš„
            const demoPoster = "https://image.tmdb.org/t/p/w300/pFlaoHTZeyNkG83vxsAJiGzfSsa.jpg"; // Black Adam example
            const fallbackPosters = Array(20).fill(demoPoster);

            try {
                if (TMDB_API_KEY && TMDB_API_KEY !== 'YOUR_TMDB_API_KEY_HERE') {
                    // å°è¯•ä» TMDB æ‹‰å–çƒ­é—¨ç”µå½± (æ‹‰å–ä¸¤é¡µä»¥è·å¾—æ›´å¤šæ•°æ®)
                    const response1 = await fetch(`https://api.themoviedb.org/3/movie/popular?api_key=${TMDB_API_KEY}&language=zh-CN&page=1`);
                    const data1 = await response1.json();
                    const response2 = await fetch(`https://api.themoviedb.org/3/movie/popular?api_key=${TMDB_API_KEY}&language=zh-CN&page=2`);
                    const data2 = await response2.json();
                    
                    let allResults = [];
                    if(data1.results) allResults = allResults.concat(data1.results);
                    if(data2.results) allResults = allResults.concat(data2.results);

                    if (allResults.length > 0) {
                        posters = allResults.map(m => posterBaseUrl + m.poster_path);
                    }
                } else {
                    console.warn('âš ï¸ æœªæ£€æµ‹åˆ°æœ‰æ•ˆ TMDB API Keyï¼Œä½¿ç”¨å¤‡ç”¨æµ·æŠ¥æ¨¡å¼ã€‚');
                    posters = fallbackPosters;
                }
            } catch (e) {
                console.error("Fetch TMDB Error:", e);
                posters = fallbackPosters;
            }

            // ç¡®ä¿æœ‰è¶³å¤Ÿçš„æµ·æŠ¥å¡«æ»¡å±å¹•ï¼Œè‡³å°‘éœ€è¦ 40 å¼ å·¦å³æ¥ä¿è¯æ»šåŠ¨æ•ˆæœ
            while (posters.length < 48) {
                posters = posters.concat(posters);
            }
            // æˆªå–åˆé€‚æ•°é‡
            const finalPosters = posters.slice(0, 48);

            // ç”Ÿæˆç½‘æ ¼ HTML å­—ç¬¦ä¸²
            let gridHtml = '';
            finalPosters.forEach((src, index) => {
                 // ä½¿ç”¨ aspect-ratio ç¡®ä¿å ä½ï¼Œloading="lazy" ä¼˜åŒ–æ€§èƒ½
                 gridHtml += `<img src="${src}" class="poster-img" loading="lazy" alt="Poster">`;
            });

            // å°†ç›¸åŒçš„ HTML æ³¨å…¥åˆ°ä¸¤ä¸ªç½‘æ ¼ä¸­ï¼Œå®ç°æ— ç¼è¿æ¥
            grid1.innerHTML = gridHtml;
            grid2.innerHTML = gridHtml;
        }

        // ==========================================
        // ğŸ”§ 2. åŸæœ‰é€»è¾‘ (å¤šè¯­è¨€ + å¡ç‰‡) - ä¿æŒä¸å˜
        // ==========================================

        const i18n = {
            "zh-CN": {
                subtitle: "å·¦å³æ»‘åŠ¨é€‰æ‹©ç»„ä»¶",
                contact: "è”ç³»ä½œè€…",
                preview: "ä¸€é”®å¯¼å…¥æˆ‘çš„é¦–é¡µ",
                importAll: "ä¸€é”®å¯¼å…¥å…¨éƒ¨æ¨¡å—",
                modalTitle: "ä¸‹æ»‘é¢„è§ˆ",
                modalBtn: "ç¡®è®¤å¹¶å¯¼å…¥é…ç½®",
                addBtn: "æ·»åŠ "
            },
            "zh-TW": {
                subtitle: "å·¦å³æ»‘å‹•é¸æ“‡çµ„ä»¶",
                contact: "è¯ç¹«ä½œè€…",
                preview: "ä¸€éµå°å…¥æˆ‘çš„é¦–é ",
                importAll: "ä¸€éµå°å…¥å…¨éƒ¨æ¨¡å¡Š",
                modalTitle: "ä¸‹æ»‘é è¦½",
                modalBtn: "ç¢ºèªä¸¦å°å…¥é…ç½®",
                addBtn: "æ·»åŠ "
            },
            "en": {
                subtitle: "Swipe to explore widgets",
                contact: "Contact Author",
                preview: "Import My Homepage",
                importAll: "Import All Modules",
                modalTitle: "Preview",
                modalBtn: "Confirm & Import",
                addBtn: "Add"
            }
        };

        const config = {
            forwardBase: "https://gocy.pages.dev/#forward://widget?url=",
            collectionUrl: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets.fwd",
            widgets: [
                { 
                    id: "anime_omni", 
                    icon: "fa-ghost", gradient: "card-gradient-1", version: "2.2.4",
                    url: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets/hebingban/animeone.js",
                    lang: {
                        "zh-CN": { title: "äºŒæ¬¡å…ƒå…¨å¢ƒèšåˆ", desc: "å¤šå¹³å°åŠ¨æ¼«æ¦œå•èšåˆ" },
                        "zh-TW": { title: "äºŒæ¬¡å…ƒå…¨å¢ƒèšåˆ", desc: "å¤šå¹³å°å‹•æ¼«æ¦œå–®èšåˆ" },
                        "en": { title: "Anime Omni", desc: "Multi-platform Anime Charts" }
                    }
                },
                { 
                    id: "trakt_cal", 
                    icon: "fa-calendar-check", gradient: "card-gradient-3", version: "1.0.8",
                    url: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets/hebingban/traktkey.js",
                    lang: {
                        "zh-CN": { title: "Trakt è¿½å‰§æ—¥å†", desc: "å…Key / ä¸ªäººä¸­å¿ƒé›†æˆ" },
                        "zh-TW": { title: "Trakt è¿½åŠ‡æ—¥æ›†", desc: "å…Key / å€‹äººä¸­å¿ƒé›†æˆ" },
                        "en": { title: "Trakt Calendar", desc: "No-Key / Personal Hub" }
                    }
                },
                { 
                    id: "variety_hub", 
                    icon: "fa-masks-theater", gradient: "card-gradient-2", version: "2.0.3",
                    url: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets/danyi/zongyi.js",
                    lang: {
                        "zh-CN": { title: "å…¨çƒç»¼è‰ºçƒ­åº¦æ¦œ", desc: "ç»¼è‰ºæ›´æ–°è¡¨ä¸çƒ­åº¦" },
                        "zh-TW": { title: "å…¨çƒç¶œè—ç†±åº¦æ¦œ", desc: "ç¶œè—æ›´æ–°è¡¨èˆ‡ç†±åº¦" },
                        "en": { title: "Variety Hub", desc: "Global Variety Show Trends" }
                    }
                },
                { 
                    id: "global_tv", 
                    icon: "fa-clock", gradient: "card-gradient-4", version: "2.0.9",
                    url: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets/hebingban/zhuijurili-one.js",
                    lang: {
                        "zh-CN": { title: "å…¨çƒè¿½å‰§æ—¶åˆ»è¡¨", desc: "å‰§é›†/ç»¼è‰º/åŠ¨æ¼«å‘¨æ›´" },
                        "zh-TW": { title: "å…¨çƒè¿½åŠ‡æ™‚åˆ»è¡¨", desc: "åŠ‡é›†/ç¶œè—/å‹•æ¼«å‘¨æ›´" },
                        "en": { title: "Global TV Schedule", desc: "Weekly TV/Show/Anime" }
                    }
                },
                { 
                    id: "western_hub", 
                    icon: "fa-star", gradient: "card-gradient-1", version: "1.0.2",
                    url: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets/hebingban/bangdan-one.js",
                    lang: {
                        "zh-CN": { title: "æ¬§ç¾é£å‘æ ‡", desc: "çƒ‚ç•ªèŒ„å£ç¢‘ & æµåª’ä½“çƒ­åº¦" },
                        "zh-TW": { title: "æ­ç¾é¢¨å‘æ¨™", desc: "çˆ›ç•ªèŒ„å£ç¢‘ & ä¸²æµç†±åº¦" },
                        "en": { title: "Western Trends", desc: "Rotten Tomatoes & Streaming" }
                    }
                },
                { 
                    id: "cinephile", 
                    icon: "fa-film", gradient: "card-gradient-2", version: "1.0.3",
                    url: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets/hebingban/movielist%26interesting.js",
                    lang: {
                        "zh-CN": { title: "å½±è¿·å®è—", desc: "ç³»åˆ—ç”µå½± & æµæ´¾æ¢ç´¢" },
                        "zh-TW": { title: "å½±è¿·å¯¶è—", desc: "ç³»åˆ—é›»å½± & æµæ´¾æ¢ç´¢" },
                        "en": { title: "Cinephile Gems", desc: "Series Collections & Genres" }
                    }
                },
                { 
                    id: "discover", 
                    icon: "fa-compass", gradient: "card-gradient-3", version: "1.0.4",
                    url: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets/hebingban/today-one.js",
                    lang: {
                        "zh-CN": { title: "æ¢ç´¢å‘ç°", desc: "ä»Šå¤©çœ‹ä»€ä¹ˆ / é‚£å¹´ä»Šæ—¥" },
                        "zh-TW": { title: "æ¢ç´¢ç™¼ç¾", desc: "ä»Šå¤©çœ‹ä»€éº¼ / é‚£å¹´ä»Šæ—¥" },
                        "en": { title: "Discovery", desc: "What to Watch / On This Day" }
                    }
                },
                { 
                    id: "media_hub", 
                    icon: "fa-network-wired", gradient: "card-gradient-4", version: "1.2.1",
                    url: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets/cn-int-bangdan.js",
                    lang: {
                        "zh-CN": { title: "å…¨çƒå½±è§†èšåˆ", desc: "Trakt / è±†ç“£ / å¹³å°åˆ†æµ" },
                        "zh-TW": { title: "å…¨çƒå½±è¦–èšåˆ", desc: "Trakt / è±†ç“£ / å¹³å°åˆ†æµ" },
                        "en": { title: "Media Aggregator", desc: "Trakt / Douban / Platforms" }
                    }
                },
                { 
                    id: "platform", 
                    icon: "fa-tv", gradient: "card-gradient-1", version: "1.0.5",
                    url: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets/zhijiyong-myself/pingtai.js",
                    lang: {
                        "zh-CN": { title: "æµåª’ä½“ç‹¬å®¶", desc: "Netflix/HBO/Bç«™è‡ªåˆ¶" },
                        "zh-TW": { title: "ä¸²æµç¨å®¶", desc: "Netflix/HBO/Bç«™è‡ªè£½" },
                        "en": { title: "Originals", desc: "Netflix/HBO/Bilibili etc." }
                    }
                },
                { 
                    id: "danmu", 
                    icon: "fa-comments", gradient: "card-gradient-2", version: "1.1.3",
                    url: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets/danmuapi-ProMax.js",
                    lang: {
                        "zh-CN": { title: "å¼¹å¹• Pro", desc: "å¤šæºAPI & ç¹ç®€è½¬æ¢" },
                        "zh-TW": { title: "å½ˆå¹• Pro", desc: "å¤šæºAPI & ç¹ç°¡è½‰æ›" },
                        "en": { title: "Danmu Pro", desc: "Multi-Source API & Convert" }
                    }
                },
                { 
                    id: "imdb", 
                    icon: "fa-ranking-star", gradient: "card-gradient-3", version: "1.0.3",
                    url: "https://raw.githubusercontent.com/MakkaPakka518/ForwardWidgets/refs/heads/main/widgets/hebingban/imdb%26cn.js",
                    lang: {
                        "zh-CN": { title: "IMDb çƒ­æ¦œ", desc: "å…¨çƒæƒå¨å½±è§†çƒ­æ¦œ" },
                        "zh-TW": { title: "IMDb ç†±æ¦œ", desc: "å…¨çƒæ¬Šå¨å½±è¦–ç†±æ¦œ" },
                        "en": { title: "IMDb Charts", desc: "Global Top Trending" }
                    }
                }
            ]
        };

        let currentLang = 'zh-CN';

        document.getElementById('import-all-btn').href = config.forwardBase + encodeURIComponent(config.collectionUrl);
        const slider = document.getElementById('slider-container');

        function renderWidgets() {
            slider.innerHTML = ''; 
            config.widgets.forEach((w, i) => {
                const gradientClass = `card-gradient-${(i % 4) + 1}`;
                const link = config.forwardBase + encodeURIComponent(w.url);
                const txt = w.lang[currentLang] || w.lang['zh-CN'];
                const addText = i18n[currentLang].addBtn;
                const card = `
                    <div class="snap-center widget-card shrink-0 w-[60vw] sm:w-[260px] h-[290px] relative rounded-[1.8rem] overflow-hidden flex flex-col group active:scale-95">
                        <div class="absolute inset-0 ${gradientClass} opacity-90"></div>
                        <div class="absolute inset-0 bg-black/20 backdrop-blur-[2px]"></div>
                        
                        <div class="relative z-10 h-full p-6 flex flex-col justify-between text-white">
                            <div>
                                <div class="w-12 h-12 rounded-xl bg-white/20 backdrop-blur-md flex items-center justify-center text-xl mb-4 shadow-lg border border-white/20">
                                    <i class="fa-solid ${w.icon}"></i>
                                </div>
                                <h3 class="text-xl font-bold leading-tight mb-2 drop-shadow-md">${txt.title}</h3>
                                <p class="text-white/80 text-xs font-medium leading-relaxed line-clamp-2">${txt.desc}</p>
                            </div>

                            <div>
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-[10px] font-mono bg-black/20 px-2 py-0.5 rounded-md">v${w.version}</span>
                                </div>
                                <a href="${link}" class="flex items-center justify-center w-full py-2.5 bg-white text-slate-900 rounded-xl font-bold shadow-xl hover:bg-slate-100 transition-colors text-sm">
                                    <i class="fa-solid fa-plus mr-2 text-[10px]"></i> ${addText}
                                </a>
                            </div>
                        </div>
                    </div>
                `;
                slider.innerHTML += card;
            });
            updateSliderEffect();
        }

        function changeLanguage(lang) {
            currentLang = lang;
            const t = i18n[lang];
            document.getElementById('subtitle').innerText = t.subtitle;
            document.getElementById('contact-btn-text').innerText = t.contact;
            document.getElementById('btn-preview').innerText = t.preview;
            document.getElementById('btn-import-all').innerText = t.importAll;
            document.getElementById('modal-title').innerText = t.modalTitle;
            document.getElementById('modal-btn').innerText = t.modalBtn;
            renderWidgets();
        }

        function updateSliderEffect() {
            const container = slider;
            const center = container.scrollLeft + container.offsetWidth / 2;
            const cards = document.querySelectorAll('.widget-card');

            cards.forEach(card => {
                const cardCenter = card.offsetLeft + card.offsetWidth / 2;
                const distance = Math.abs(center - cardCenter);
                if (distance < container.offsetWidth * 0.35) {
                    card.classList.add('is-active');
                } else {
                    card.classList.remove('is-active');
                }
            });
        }

        slider.addEventListener('scroll', updateSliderEffect);
        
        // ğŸš€ åˆå§‹åŒ–
        renderWidgets();
        initPosterWall(); // å¯åŠ¨æµ·æŠ¥å¢™
        setTimeout(updateSliderEffect, 100);

        function spinAvatar(el) {
            const img = el.querySelector('img');
            img.classList.remove('spin-active');
            void img.offsetWidth; 
            img.classList.add('spin-active');
            if(navigator.vibrate) navigator.vibrate(50);
        }

        function randomTitleColor(el) {
            const text = document.getElementById('title-text');
            const colors = ['from-blue-400 to-purple-400', 'from-green-400 to-cyan-400', 'from-yellow-400 to-red-400', 'from-pink-400 to-rose-400'];
            const newColor = colors[Math.floor(Math.random() * colors.length)];
            text.className = `bg-clip-text text-transparent bg-gradient-to-r ${newColor} transition-all duration-500`;
        }

        function togglePreview(show) {
            const modal = document.getElementById('preview-modal');
            if (show) {
                modal.classList.remove('hidden');
                setTimeout(() => modal.classList.remove('opacity-0'), 10);
            } else {
                modal.classList.add('opacity-0');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
        }
    </script>
</body>
</html>
